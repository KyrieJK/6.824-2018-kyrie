# 分布式系统基础理论(十一)	分布式事务


   * [分布式系统基础理论(十一)	分布式事务](#分布式系统基础理论十一分布式事务)
      * [什么是事务](#什么是事务)
      * [分布式事务](#分布式事务)
         * [什么是分布式事务](#什么是分布式事务)
         * [为什么会出现分布式事务](#为什么会出现分布式事务)
      * [刚性事务OR柔性事务](#刚性事务or柔性事务)
      * [两阶段提交](#两阶段提交)
      * [三阶段提交](#三阶段提交)
      * [TCC](#tcc)
      * [基于MQ的消息一致性](#基于mq的消息一致性)
      * [基本本地消息表的最终一致性](#基本本地消息表的最终一致性)


## 什么是事务

提到事务，我们一般的认知是数据库中的Transaction，事务的四大特性想必大家也非常熟悉：ACID，原子性，一致性，隔离性，持久性。在这篇文章中我不会深入去说ACID四大特性的具体内容，这里简单介绍一下事务即可，毕竟这篇文章主要是深入讲解分布式事务。

简单来说事务是一个操作序列，这些操作要么都执行，要么都不执行，它是一个不可分割的工作单元。举个最经典的例子来说：银行转账，我们要从A账户转1000元到B账户。正常情况下如果从A转出1000到B账户之后，A账户余额减1000，B账户余额增加1000，我们分别用A1和B1操作来表示。

我们当前需要明确一点，在系统中，从A账户减1000和B账户余额增加1000，这是两个操作。既然是两个操作就一定存在先后执行顺序，所以就有可能出现A1操作完毕后正准备去执行B1操作，这时数据库宕机了。如果我们不对这种异常情况加以考虑，那么就会出现，A账户的钱减少了1000，B账户的余额却没有增加，钱不翼而飞了。这种问题在银行业务中是绝对禁止出现的，因为为了解决“钱”的问题，引入了“事务”的概念。银行为了防止这种小概率事件发生，如果A和B无法同时成功，那么在出现问题的时候，事务保证这两个操作会同时失败。因此事务通过ACID特性，保证一系列的操作在任何情况下都可以安全正确地执行。

## 分布式事务

### 什么是分布式事务



### 为什么会出现分布式事务

## 刚性事务OR柔性事务

## 两阶段提交

## 三阶段提交

## TCC

## 基于MQ的消息一致性

## 基本本地消息表的最终一致性